<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BushBuddy</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#698167" />
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #e7f5e4 100%); min-height: 100vh; }
.container { max-width: 1200px; margin: 0 auto; }
.header { text-align: center; margin-bottom: 30px; color: #657a6b; }
.header h1 { margin: 0; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }

/* Improved Navigation Tabs */
.main-nav { 
  display: flex; 
  justify-content: center; 
  margin-bottom: 30px; 
  background: white; 
  border-radius: 15px; 
  padding: 10px; 
  box-shadow: 0 8px 32px rgba(0,0,0,0.1); 
  backdrop-filter: blur(10px);
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.main-nav::-webkit-scrollbar { display: none; }

.nav-tab { 
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 12px 16px; 
  margin: 0 4px; 
  border: none; 
  background: transparent; 
  color: #666; 
  cursor: pointer; 
  border-radius: 10px; 
  transition: all 0.3s ease; 
  font-weight: 600; 
  position: relative; 
  overflow: hidden;
  white-space: nowrap;
  min-width: 80px;
  font-size: 12px;
}

.nav-tab-icon {
  font-size: 20px;
  margin-bottom: 4px;
  transition: transform 0.3s ease;
}

.nav-tab-text {
  font-size: 11px;
  text-align: center;
  line-height: 1.2;
}

.nav-tab:hover { 
  background: rgba(43,122,120,0.1); 
  color: #657a6b; 
}

.nav-tab:hover .nav-tab-icon {
  transform: scale(1.1);
}

.nav-tab.active { 
  background: linear-gradient(135deg, #698167, #a0b2af); 
  color: white; 
  box-shadow: 0 4px 15px rgba(43,122,120,0.3); 
}

/* Card Styles */
.card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); margin-bottom: 25px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); }
.card h2 { margin-top: 0; color: #698167; font-size: 1.8em; }

/* Form Elements */
label { display: block; margin-top: 15px; font-weight: 600; color: #555; }
input, select, textarea { 
  width: 100%; 
  padding: 12px; 
  margin-top: 6px; 
  border-radius: 10px; 
  border: 2px solid #e1e8ed; 
  box-sizing: border-box; 
  transition: all 0.3s ease; 
  font-size: 16px;
}
input:focus, select:focus, textarea:focus { 
  outline: none; 
  border-color: #698167; 
  box-shadow: 0 0 0 3px rgba(43,122,120,0.1); 
}
textarea { resize: vertical; min-height: 80px; }

/* Buttons */
button { 
  margin: 8px 4px; 
  padding: 12px 20px; 
  border: none; 
  border-radius: 10px; 
  background: linear-gradient(135deg, #698167, #a0b2af); 
  color: white; 
  cursor: pointer; 
  font-weight: 600; 
  transition: all 0.3s ease; 
  min-height: 44px;
  font-size: 14px;
}
button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(43,122,120,0.3); }
button.small { padding: 8px 12px; font-size: 12px; margin: 2px; min-height: 36px; }
button.danger { background: linear-gradient(135deg, #dc3545, #e74c3c); }

/* Content Sections */
.tab-content { display: none; }
.tab-content.active { display: block; animation: fadeIn 0.3s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* Animal List */
.animal-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px; }
.animal-item { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 6px 25px rgba(0,0,0,0.1); position: relative; }
.animal-item h4 { margin-top: 0; color: #698167; }
.animal-actions { position: absolute; top: 15px; right: 15px; display: flex; gap: 5px; }

/* Responsive Design */
@media (max-width: 768px) {
  body { padding: 10px; }
  .header h1 { font-size: 2em; }
  .main-nav { padding: 8px; margin-bottom: 20px; }
  .nav-tab { padding: 10px 12px; margin: 0 2px; min-width: 70px; }
  .nav-tab-icon { font-size: 18px; margin-bottom: 3px; }
  .nav-tab-text { font-size: 10px; }
  .card { padding: 20px; }
  .animal-grid { grid-template-columns: 1fr; }
}

@media (max-width: 480px) {
  .nav-tab { min-width: 60px; padding: 8px 10px; }
  .nav-tab-icon { font-size: 16px; }
  .nav-tab-text { font-size: 9px; }
}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>BushBuddy</h1>
    <p>Professional Wildlife Care Management System</p>
  </div>

  <!-- Main Navigation with Icons -->
  <div class="main-nav">
    <button class="nav-tab active" onclick="showTab('animals')">
      <div class="nav-tab-icon">üêæ</div>
      <div class="nav-tab-text">Animal<br>Management</div>
    </button>
    <button class="nav-tab" onclick="showTab('weight')">
      <div class="nav-tab-icon">‚öñÔ∏è</div>
      <div class="nav-tab-text">Weight &<br>Feed</div>
    </button>
    <button class="nav-tab" onclick="showTab('feeding')">
      <div class="nav-tab-icon">üçº</div>
      <div class="nav-tab-text">Feeding<br>Log</div>
    </button>
    <button class="nav-tab" onclick="showTab('health')">
      <div class="nav-tab-icon">üè•</div>
      <div class="nav-tab-text">Health<br>Tracking</div>
    </button>
    <button class="nav-tab" onclick="showTab('photos')">
      <div class="nav-tab-icon">üì∑</div>
      <div class="nav-tab-text">Photo<br>Gallery</div>
    </button>
    <button class="nav-tab" onclick="showTab('export')">
      <div class="nav-tab-icon">üìã</div>
      <div class="nav-tab-text">Care<br>Handover</div>
    </button>
  </div>

  <!-- Animal Management Tab -->
  <div id="animalsTab" class="tab-content active">
    <div class="card">
      <h2>Add New Animal</h2>
      <label>Name: <input type="text" id="animalName" placeholder="Enter animal name"></label>
      <label>Species: 
        <select id="animalSpecies">
          <option value="Common Brushtail Possum">Common Brushtail Possum</option>
          <option value="Ringtail Possum">Ringtail Possum</option>
          <option value="Short-Eared Brushtail Possum">Short-Eared Brushtail Possum</option>
        </select>
      </label>
      <label>Intake Date: <input type="date" id="intakeDate"></label>
      <label>Intake Notes: <textarea id="intakeNotes" placeholder="Circumstances of rescue, initial condition, etc."></textarea></label>
      <button onclick="addNewAnimal()">Add Animal</button>
    </div>

    <div class="card">
      <h2>Your Animals</h2>
      <div id="animalList" class="animal-grid">
        <p style="text-align: center; color: #666; font-style: italic;">No animals added yet. Add your first animal above!</p>
      </div>
    </div>
  </div>

  <!-- Other tabs (simplified for testing) -->
  <div id="weightTab" class="tab-content">
    <div class="card">
      <h2>Weight Tracking</h2>
      <p>Weight tracking functionality will be available once you add animals.</p>
    </div>
  </div>

  <div id="feedingTab" class="tab-content">
    <div class="card">
      <h2>Feeding Log</h2>
      <p>Feeding log functionality will be available once you add animals.</p>
    </div>
  </div>

  <div id="healthTab" class="tab-content">
    <div class="card">
      <h2>Health Tracking</h2>
      <p>Health tracking functionality will be available once you add animals.</p>
    </div>
  </div>

  <div id="photosTab" class="tab-content">
    <div class="card">
      <h2>Photo Gallery</h2>
      <p>Photo gallery functionality will be available once you add animals.</p>
    </div>
  </div>

  <div id="exportTab" class="tab-content">
    <div class="card">
      <h2>Care Handover</h2>
      <p>Export functionality will be available once you add animals.</p>
    </div>
  </div>

</div>

<script>
// Initialize animals array
let animals = [];

// Format date function
function formatDateDMY(dateStr) {
  if (!dateStr) return '';
  const date = new Date(dateStr);
  if (isNaN(date)) return dateStr;
  const day = String(date.getDate()).padStart(2, '0');
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const year = date.getFullYear();
  return `${day}-${month}-${year}`;
}

// Tab navigation function
function showTab(tabName) {
  // Hide all tabs
  document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
  
  // Show selected tab
  event.target.classList.add('active');
  document.getElementById(tabName + 'Tab').classList.add('active');
}

// Add animal function
function addNewAnimal() {
  console.log('addNewAnimal function called');
  
  const name = document.getElementById('animalName').value.trim();
  const species = document.getElementById('animalSpecies').value;
  const intakeDate = document.getElementById('intakeDate').value;
  const intakeNotes = document.getElementById('intakeNotes').value.trim();
  
  console.log('Form values:', { name, species, intakeDate, intakeNotes });
  
  if (!name || !species) {
    alert('Please enter animal name and species.');
    return;
  }
  
  const newAnimal = { 
    id: Date.now(), 
    name, 
    species, 
    intakeDate: intakeDate || new Date().toISOString().split('T')[0],
    intakeNotes: intakeNotes || '',
    weights: [], 
    feedingLog: [], 
    healthEntries: [],
    photos: []
  };
  
  console.log('New animal object:', newAnimal);
  
  animals.push(newAnimal);
  console.log('Animals array:', animals);
  
  renderAnimalList();
  
  // Clear form
  document.getElementById('animalName').value = '';
  document.getElementById('intakeDate').value = new Date().toISOString().split('T')[0];
  document.getElementById('intakeNotes').value = '';
  
  alert(name + ' has been added successfully!');
}

// Render animals list
function renderAnimalList() {
  const list = document.getElementById('animalList');
  list.innerHTML = '';
  
  if (animals.length === 0) {
    list.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">No animals added yet. Add your first animal above!</p>';
    return;
  }
  
  animals.forEach(animal => {
    const div = document.createElement('div');
    div.className = 'animal-item';
    
    const daysSinceIntake = animal.intakeDate ? 
      Math.floor((new Date() - new Date(animal.intakeDate)) / (1000 * 60 * 60 * 24)) : 
      'Unknown';
    
    div.innerHTML = `
      <div class="animal-actions">
        <button class="small danger" onclick="deleteAnimal(${animal.id})">üóëÔ∏è</button>
      </div>
      <h4>${animal.name}</h4>
      <p><strong>Species:</strong> ${animal.species}</p>
      <p><strong>Intake:</strong> ${formatDateDMY(animal.intakeDate) || 'Not recorded'} (${daysSinceIntake} days ago)</p>
      ${animal.intakeNotes ? `<p><strong>Notes:</strong> ${animal.intakeNotes}</p>` : ''}
    `;
    
    list.appendChild(div);
  });
}

// Delete animal function
function deleteAnimal(id) {
  const animal = animals.find(a => a.id == id);
  if (!animal) return;
  
  if (!confirm(`Delete ${animal.name}? This cannot be undone.`)) return;
  
  animals = animals.filter(a => a.id != id);
  renderAnimalList();
}

// Initialize the app
document.addEventListener('DOMContentLoaded', function() {
  // Set today's date as default
  const today = new Date().toISOString().split('T')[0];
  const intakeDateEl = document.getElementById('intakeDate');
  if (intakeDateEl) intakeDateEl.value = today;
  
  console.log('App initialized');
});
</script>
</body>
</html>
